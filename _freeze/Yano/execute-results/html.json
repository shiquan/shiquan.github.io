{
  "hash": "d2079d60410bf77154bf8ca613170801",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Yano\ndescription: Spatial dissimilarity analysis in single cells\nsidebar: false\n---\n\n## Introduction\n\nYano represents an R/C toolkit designed for conducting spatial dissimilarity analysis on single-cell RNA sequencing data. This method revolves around the core concept of examining the distinct expression patterns of a given feature (e.g. exon, snp allele) in relation to its associated binding feature (typically a gene or another allele at the same genomic locus) within the context of cell lineage (1D), spatial position (2D), or the multi-dimensional PCA space. The discernible differences in feature expression patterns and their binding features provide insights into a range of biological phenomena, including alternative splicing, cis-antisense RNA regulation, allele-specific gene expression, and more.\n\nYano is seamlessly integrated with Seurat, building upon the Seurat object's framework. Users can perform conventional cell clustering analyses using the state-of-the-art Seurat pipeline and then incorporate exon, SNP counts as new \"assays\" within the Seurat objects. Subsequently, Yano facilitates the assessment of spatial dissimilarity between these two assays. For more details about the method, please refer to our [manuscript](https://doi.org/10.1016/j.crmeth.2025.101141).\n\n## INSTALL\n\n```r\nif (!require(\"BiocManager\")) install.packages('BiocManager') \nBiocManager::install(\"shiquan/Yano\")\n```\n***Notice:*** Multithread mode is disabled on macOS by default due to the lack of OpenMP support. The R package `data.table` provides a useful tutorial on how to enable OpenMP on macOS. Please refer to this guide: [https://github.com/Rdatatable/data.table/wiki/Installation#enable-openmp-for-macos](https://github.com/Rdatatable/data.table/wiki/Installation#enable-openmp-for-macos) for more info.\n\n## Get started\n\nTo fast hand-on the Yano workflow, you could get started with the built-in dataset.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrequire(Yano)\ndata(\"glbt_small\")\nDefaultAssay(glbt_small) <- \"RNA\"\nglbt_small <- NormalizeData(glbt_small) %>% RunUMAP(dim = 1:20)\n\nDimPlot(glbt_small, label = TRUE, label.size = 5)\n```\n\n::: {.cell-output-display}\n![](Yano_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=960}\n:::\n\n```{.r .cell-code}\nDefaultAssay(glbt_small) <- \"exon\"\nglbt_small <- NormalizeData(glbt_small)\nMeta(glbt_small) %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndata frame with 0 columns and 6 rows\n```\n\n\n:::\n\n```{.r .cell-code}\nglbt_small <- ParseExonName(glbt_small)\nMeta(glbt_small) %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                    chr     start       end gene_name strand\nchr1:154169305-154169383/-/TPM3    chr1 154169305 154169383      TPM3      -\nchr11:35197162-35197793/+/CD44    chr11  35197162  35197793      CD44      +\nchr11:75421727-75422280/+/RPS3    chr11  75421727  75422280      RPS3      +\nchr11:123060825-123061329/-/HSPA8 chr11 123060825 123061329     HSPA8      -\nchr11:123061588-123061833/-/HSPA8 chr11 123061588 123061833     HSPA8      -\nchr11:123061869-123062022/-/HSPA8 chr11 123061869 123062022     HSPA8      -\n```\n\n\n:::\n\n```{.r .cell-code}\ngrep(\"_wm$\",names(glbt_small), value=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ncharacter(0)\n```\n\n\n:::\n\n```{.r .cell-code}\nglbt_small <- RunAutoCorr(glbt_small)\ngrep(\"_wm$\",names(glbt_small), value=TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"pca_wm\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Perform spatial dissimilarity test\nglbt_small <- RunSDT(glbt_small, bind.name = \"gene_name\", bind.assay = \"RNA\")\nMeta(glbt_small) %>% head\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                    chr     start       end gene_name strand\nchr1:154169305-154169383/-/TPM3    chr1 154169305 154169383      TPM3      -\nchr11:35197162-35197793/+/CD44    chr11  35197162  35197793      CD44      +\nchr11:75421727-75422280/+/RPS3    chr11  75421727  75422280      RPS3      +\nchr11:123060825-123061329/-/HSPA8 chr11 123060825 123061329     HSPA8      -\nchr11:123061588-123061833/-/HSPA8 chr11 123061588 123061833     HSPA8      -\nchr11:123061869-123062022/-/HSPA8 chr11 123061869 123062022     HSPA8      -\n                                   moransi.pval    moransi autocorr.variable\nchr1:154169305-154169383/-/TPM3   2.145482e-108 0.09755124              TRUE\nchr11:35197162-35197793/+/CD44     0.000000e+00 0.25567534              TRUE\nchr11:75421727-75422280/+/RPS3     4.384004e-38 0.05692909              TRUE\nchr11:123060825-123061329/-/HSPA8  1.099318e-63 0.07462142              TRUE\nchr11:123061588-123061833/-/HSPA8 7.646557e-158 0.11891354              TRUE\nchr11:123061869-123062022/-/HSPA8 1.467547e-150 0.11541279              TRUE\n                                  gene_name.D gene_name.t gene_name.pval\nchr1:154169305-154169383/-/TPM3     0.3344933  -9.6340128   3.439535e-16\nchr11:35197162-35197793/+/CD44      0.1936528  -0.8157995   2.082866e-01\nchr11:75421727-75422280/+/RPS3      0.2897101  -9.7711232   1.727161e-16\nchr11:123060825-123061329/-/HSPA8   0.2476866  -9.0117255   7.811378e-15\nchr11:123061588-123061833/-/HSPA8   0.3451070 -13.5566239   1.350080e-24\nchr11:123061869-123062022/-/HSPA8   0.3272413 -14.0211106   1.489731e-25\n                                  gene_name.padj\nchr1:154169305-154169383/-/TPM3     1.223492e-14\nchr11:35197162-35197793/+/CD44      1.000000e+00\nchr11:75421727-75422280/+/RPS3      6.450946e-15\nchr11:123060825-123061329/-/HSPA8   2.652318e-13\nchr11:123061588-123061833/-/HSPA8   6.723397e-23\nchr11:123061869-123062022/-/HSPA8   7.948777e-24\n```\n\n\n:::\n\n```{.r .cell-code}\n# Manhattan plot for spatial dissimilarity test result\nFbtPlot(glbt_small, val = \"gene_name.padj\")\n```\n\n::: {.cell-output-display}\n![](Yano_files/figure-html/unnamed-chunk-1-2.png){fig-align='center' width=960}\n:::\n\n```{.r .cell-code}\nFeaturePlot(glbt_small, features = c(\"chr19:16095264-16095454/+/TPM4\", \"TPM4\"), order=TRUE)\n```\n\n::: {.cell-output-display}\n![](Yano_files/figure-html/unnamed-chunk-1-3.png){fig-align='center' width=960}\n:::\n\n```{.r .cell-code}\n# Track plot for gene coverage at different cell types\ndb <- gtf2db(\"./gencode.v44.annotation.gtf.gz\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[2026-01-13 14:11:41] GTF loading..\n[2026-01-13 14:12:25] Load 62700 genes.\n[2026-01-13 14:12:25] Load time : 43.936 sec\n```\n\n\n:::\n\n```{.r .cell-code}\nTrackPlot(bamfile=\"./Parent_SC3v3_Human_Glioblastoma_possorted_genome_bam.bam\", gtf =db, gene = \"TPM4\", junc = TRUE, cell.group = Idents(glbt_small), highlights = c(16095264,16095454))\n```\n\n::: {.cell-output-display}\n![](Yano_files/figure-html/unnamed-chunk-1-4.png){fig-align='center' width=960}\n:::\n:::\n\n\nSee short cases for more details.\n\n## Short cases\n\n- [Alternative splicing analysis for scRNA-seq](Yano_AS.Rmd)\n- [Allele-specific gene expression analysis for scRNA-seq](Yano_ASE.Rmd)\n- [Annotating and prioritizing genetic variants for scRNA-seq](Yano_anno.Rmd)\n- [Perform alternative splicing analysis for multiple Visium samples](Visium.Rmd)\n- [Select cells from reduction maps](selector.Rmd)\n- [Perform alternative splicing analysis for cell trajectory and user-defined embeddings](Yano_trajectory.Rmd)\n\n## Changelog\n<details>\n<summary>1.2 2025/06/18</summary>\n\n* Rename RunBlockCorr to RunSDT.\n* Reimplement core algorithm with sparse matrix structure. Highly improved speed (>3x).\n\n\n</details>\n\n\n<details>\n<summary>1.1 2025/06/02</summary>\n\nSimplified parameters for RunCorrBlock() to streamlines the function and makes it more concise. In addition, new selector functions, *Selector(), introduced.\n\n</details>\n\n<details>\n<summary>1.0 2025/02/19</summary>\n\nFirst stable release.\n\n</details>\n\n<details>\n<summary>0.0.0.9999 2023/03/22</summary>\n\nInit version.\n\n</details>\n\n## Issues or questions\n\n- [https://github.com/shiquan/Yano/issues](https://github.com/shiquan/Yano/issues)\n- [https://github.com/shiquan/Yano/discussions](https://github.com/shiquan/Yano/discussions)\n\n<!--\n## Functions\n\nFunction(s) | Description\n|---|---|\n|[annoBED](Yano/annoBED.md)|Annotate BED with preload GTF.|\n|[annoVAR](Yano/annoVAR.md)|Annotate genetic variants with preload GTF and/or VCF databases.|\n|[AutoCorrFeatures](Yano/AutoCorrFeatures.md)|Select spatial autocorrelated features.|\n|[FbtPlot](Yano/FbtPlot.md)|Generate a mahattan plot for features.|\n|[FindAltExp](Yano/FindAltExp.md)|Find group specific alternative expressed features.|\n|[FindAllAltExp](Yano/FindAllAltExp.md)|Find alternative expressed features for all groups.|\n|[GetWeights](Yano/GetWeights.md)|Get weight matrix.|\n|[gtf2db](Yano/gtf2db.md)|Load GTF database into memory.|\n|[mergeMatrix](Yano/mergeMatrix-SMatrix-method.md)|Merge two or more count matrix into one.|\n|[ParseBED](Yano/ParseBED.md)|Parse chromsome name, locations and strand from BED names.|\n|[ParseExonName](Yano/ParseExonName.md)|Parse chromsome name, locations, strand and gene name from Exon/Junction names.|\n|[ParseVarName](Yano/ParseVarName.md)|Parse chromsome name, locations and strand from genetic variant names.|\n|[PSIPlot](Yano/PSIPlot.md)|Plot Percent Spliced-IN value on a reduction map.|\n|[RatioPlot](Yano/RatioPlot.md)|Plot ratio of feature and binding feature expression on a reduction map.|\n|[ReadPISA](Yano/ReadPISA.md)|Load raw matrix which generated by PISA.|\n|[RunAutoCorr](Yano/RunAutoCorr.md)|Perform spatial autocorrelation test for features.|\n|[RunSDT](Yano/RunBlockCorr.md)|Perform spatial dissimilarity test for features.|\n|[RunDEXSeq](Yano/RunDEXSeq.md)|Run alternative expression analysis with DEXSeq.|\n|[QuickRecipe](Yano/QuickRecipe-Seurat-method.md)|Run Seurat pipeline.|\n|[SetAutoCorrFeatures](Yano/SetAutoCorrFeatures.md)|Setup spatial autocorrelated features.|\n|[TrackPlot](Yano/TrackPlot.md)|Generate tracks plot from BAM(s).|\n|[varanno](Yano/varanno.md)|Low level version of annoVAR, need specify chr, position manually.|\n\n-->\n",
    "supporting": [
      "Yano_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}